   <!DOCTYPE html>
<html dir="rtl">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  margin: 0;
  min-width: 250px;
}

/* Include the padding and border in an element's total width and height */
* {
  box-sizing: border-box;
}

/* Remove margins and padding from the list */
ul {
  margin: 0;
  padding: 0;
}

/* Style the list items */
ul li {
  cursor: pointer;
  position: relative;
  padding: 12px 8px 12px 40px;

  list-style-type: none;
  background: #eee;
  font-size: 18px;
  transition: 0.2s;
  
  /* make the list items unselectable */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/* Set all odd list items to a different color (zebra-stripes) */
ul li:nth-child(odd) {
  background: #f9f9f9;
}

/* Darker background-color on hover */
ul li:hover {
  background: #ddd;
}

/* When clicked on, add a background color and strike out text */
ul li.checked {
  background: #888;
  color: #fff;
  text-decoration: line-through;
}

/* Add a "checked" mark when clicked on */
ul li.checked::before {
  content: '';
  position: absolute;
  border-color: #fff;
  border-style: solid;
  border-width: 0 2px 2px 0;
  top: 10px;
  left: 56px;
  transform: rotate(45deg);
  height: 15px;
  width: 7px;
}

/* Style the close button */
.close {
  position: absolute;
  left: 0;
  top: 0;
  padding: 12px 16px 12px 16px;
}

.close:hover {
  background-color: #f44336;
  color: white;
}

/* Style the header */
.header {
  background-color: #f44336;
  padding: 30px 40px;
  color: white;
  text-align: center;
}

/* Clear floats after the header */
.header:after {
  content: "";
  display: table;
  clear: both;
}

/* Style the input */
input {
  margin: 0;
  border: none;
  border-radius: 0;
  width: 75%;
  padding: 10px;
  float: left;
  font-size: 16px;
}

/* Style the "Add" button */
.addBtn {
  padding: 10px;
  width: 25%;
  background: #d9d9d9;
  color: #555;
  float: left;
  text-align: center;
  font-size: 16px;
  cursor: pointer;
  transition: 0.3s;
  border-radius: 0;
}

.addBtn:hover {
  background-color: #bbb;
}

.toolbar {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin: 20px auto;
  flex-wrap: wrap;
}

.toolbar button {
  padding: 10px 16px;
  font-size: 16px;
  background-color: #f1f1f1;
  border: 1px solid #ccc;
  cursor: pointer;
  border-radius: 6px;
  transition: background-color 0.3s;
  display: flex;
  align-items: center;
  gap: 6px;
}

.toolbar button:hover {
  background-color: #ddd;
}

</style>
</head>
<body>

<div id="myDIV" class="header">
  <h2 style="margin:5px">×¨×©×™××ª ××˜×œ×•×ª</h2>
  <input type="text" id="myInput" placeholder="××˜×œ×” ×—×“×©×”...">
  <span onclick="newElement()" class="addBtn">×”×•×¡×£</span>
</div>


<div class="toolbar">
  <button onclick="newElement()">â• ×”×•×¡×£</button>
  <button onclick="copyListToClipboard()">ğŸ“‹ ×”×¢×ª×§ ×œ×œ×•×—</button>
  <button onclick="printTaskList()">ğŸ–¨ï¸ ×”×“×¤×¡</button>
  <button onclick="exportListToCSV()">ğŸ“„ ×™×™×¦×•× ×œ-Excel</button>
  <input type="file" id="importCSV" accept=".csv" style="display: none;" onchange="importCSV(this)">
<button onclick="document.getElementById('importCSV').click()">ğŸ“¥ ×˜×¢×Ÿ ××˜×œ×•×ª ××§×•×‘×¥</button>

</div>



<ul id="myUL">

  <li class="checked">×œ×¡××Ÿ ×›× ×™×¡×”</li>
    <li>×œ×¢×‘×•×¨ ×¢×œ ×”××™×™×œ×™× ×©×œ ×”×¦×’</li>
  <li>×œ×¢×‘×•×¨ ×¢×œ ×”××™×™×œ×™× ×©×œ ××–×›×™×¨×•×ª</li>
  


  <li>×œ×¢×‘×•×¨ ×¢×œ ×”××™×™×œ×™× ×©×œ ×¦×œ×¦×•×œ</li>
  <!--<li>Read a book</li>
  <li>Organize office</li>-->
</ul>

<script>
// Create a "close" button and append it to each list item
var myNodelist = document.getElementsByTagName("LI");
var i;
for (i = 0; i < myNodelist.length; i++) {
  var span = document.createElement("SPAN");
  var txt = document.createTextNode("\u00D7");
  span.className = "close";
  span.appendChild(txt);
  myNodelist[i].appendChild(span);
}

// Click on a close button to hide the current list item
var close = document.getElementsByClassName("close");
var i;
for (i = 0; i < close.length; i++) {
  close[i].onclick = function() {
    var div = this.parentElement;
    div.style.display = "none";
  }
}

// Add a "checked" symbol when clicking on a list item
var list = document.querySelector('ul');
list.addEventListener('click', function(ev) {
  if (ev.target.tagName === 'LI') {
    ev.target.classList.toggle('checked');
  }
}, false);

// Create a new list item when clicking on the "Add" button
function newElement() {
  var li = document.createElement("li");
  var inputValue = document.getElementById("myInput").value;
  var t = document.createTextNode(inputValue);
  li.appendChild(t);
  if (inputValue === '') {
    alert("××•×¤×¡! × ×¨××” ×©×œ× ×”×–× ×ª ×©×•× ××˜×œ×”, ×›×ª×•×‘ ××©×”×•...");
  } else {
    document.getElementById("myUL").appendChild(li);
  }
  document.getElementById("myInput").value = "";

  var span = document.createElement("SPAN");
  var txt = document.createTextNode("\u00D7");
  span.className = "close";
  span.appendChild(txt);
  li.appendChild(span);

  for (i = 0; i < close.length; i++) {
    close[i].onclick = function() {
      var div = this.parentElement;
      div.style.display = "none";
    }
  }
}
document.getElementById("myInput").addEventListener("keydown", function(event) {
  if (event.key === "Enter") {
    event.preventDefault(); // ××•× ×¢ ×©×œ×™×—×” ×©×œ ×˜×•×¤×¡ ×× ×™×©
    newElement();
  }
});

function copyListToClipboard() {
  var items = document.querySelectorAll("#myUL li");
  var textToCopy = "××˜×œ×”\t×‘×•×¦×¢\n";

  items.forEach(function(item) {
    var taskText = item.childNodes[0].nodeValue.trim();
    var done = item.classList.contains("checked") ? "âœ“" : "";
    textToCopy += taskText + "\t" + done + "\n";
  });

  // ×”×¢×ª×§×” ×œ×œ×•×—
  navigator.clipboard.writeText(textToCopy).then(function() {
    alert("×”×¨×©×™××” ×”×•×¢×ª×§×” ×œ×œ×•×—!");
  }, function(err) {
    alert("×©×’×™××” ×‘×”×¢×ª×§×” ×œ×œ×•×—: " + err);
  });
}

function exportListToFile() {
  var items = document.querySelectorAll("#myUL li");
  var textToExport = "××˜×œ×”\t×‘×•×¦×¢\n";

  items.forEach(function(item) {
    var taskText = item.childNodes[0].nodeValue.trim();
    var done = item.classList.contains("checked") ? "âœ“" : "";
    textToExport += taskText + "\t" + done + "\n";
  });

  var blob = new Blob([textToExport], { type: "text/plain;charset=utf-8" });
  var link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "×¨×©×™××ª_××˜×œ×•×ª.txt";
  link.click();
}
function exportListToCSV() {
  var items = document.querySelectorAll("#myUL li");
  var csvContent = "××˜×œ×”,×‘×•×¦×¢\n";

  items.forEach(function(item) {
    var taskText = item.childNodes[0].nodeValue.trim().replace(/,/g, " ");
    var done = item.classList.contains("checked") ? "âœ“" : "";
    csvContent += `"${taskText}","${done}"\n`;
  });

  // ×”×•×¡×¤×ª BOM ×œ×§×™×“×•×“ ×ª×§×™×Ÿ ×‘×¢×‘×¨×™×ª
  var bom = "\uFEFF";
  var blob = new Blob([bom + csvContent], { type: "text/csv;charset=utf-8;" });

  var link = document.createElement("a");
  var url = URL.createObjectURL(blob);
  link.setAttribute("href", url);
  link.setAttribute("download", "×¨×©×™××ª_××˜×œ×•×ª.csv");
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

function printTaskList() {
  var items = document.querySelectorAll("#myUL li");
  var printWindow = window.open('', '', 'height=600,width=800');
  printWindow.document.write('<html><head><title>×¨×©×™××ª ××˜×œ×•×ª</title>');
  printWindow.document.write('<style>body{font-family:Arial; direction:rtl; text-align:right;} table{width:100%; border-collapse:collapse;} th, td{border:1px solid #000; padding:8px;} th{background-color:#f44336; color:#fff;}</style>');
  printWindow.document.write('</head><body>');
  printWindow.document.write('<h2>×¨×©×™××ª ××˜×œ×•×ª</h2>');
  printWindow.document.write('<table><tr><th>××˜×œ×”</th><th>×‘×•×¦×¢</th></tr>');

  items.forEach(function(item) {
    var taskText = item.childNodes[0].nodeValue.trim();
    var done = item.classList.contains("checked") ? "âœ“" : "";
    printWindow.document.write('<tr><td>' + taskText + '</td><td>' + done + '</td></tr>');
  });

  printWindow.document.write('</table>');
  printWindow.document.write('</body></html>');
  printWindow.document.close();
  printWindow.focus();
  printWindow.print();
  printWindow.close();
}
function copyListToClipboard() {
  var items = document.querySelectorAll("#myUL li");
  var text = "××˜×œ×”\t×‘×•×¦×¢\n";
  items.forEach(function(item) {
    var task = item.childNodes[0].nodeValue.trim();
    var done = item.classList.contains("checked") ? "âœ“" : "";
    text += task + "\t" + done + "\n";
  });
  navigator.clipboard.writeText(text).then(() => {
    alert("×”×¨×©×™××” ×”×•×¢×ª×§×” ×œ×œ×•×—!");
  });
}

function printTaskList() {
  var items = document.querySelectorAll("#myUL li");
  var printWindow = window.open('', '', 'height=600,width=800');
  printWindow.document.write('<html><head><title>×¨×©×™××ª ××˜×œ×•×ª</title>');
  printWindow.document.write('<style>body{font-family:Arial; direction:rtl; text-align:right;} table{width:100%; border-collapse:collapse;} th, td{border:1px solid #000; padding:8px;} th{background-color:#f44336; color:#fff;}</style>');
  printWindow.document.write('</head><body>');
  printWindow.document.write('<h2>×¨×©×™××ª ××˜×œ×•×ª</h2><table><tr><th>××˜×œ×”</th><th>×‘×•×¦×¢</th></tr>');
  items.forEach(function(item) {
    var taskText = item.childNodes[0].nodeValue.trim();
    var done = item.classList.contains("checked") ? "âœ“" : "";
    printWindow.document.write('<tr><td>' + taskText + '</td><td>' + done + '</td></tr>');
  });
  printWindow.document.write('</table></body></html>');
  printWindow.document.close();
  printWindow.focus();
  printWindow.print();
  printWindow.close();
}



function downloadCSV() {
  const items = [];
  document.querySelectorAll("#myUL li").forEach(li => {
    items.push({
      text: li.firstChild.textContent,
      done: li.classList.contains("checked") ? "âœ“" : ""
    });
  });

  // ×™×¦×™×¨×ª ×ª××¨×™×š ×‘×¤×•×¨××˜ DD/MM/YYYY
  const today = new Date();
  const date = `${today.getDate().toString().padStart(2, '0')}/${(today.getMonth() + 1).toString().padStart(2, '0')}/${today.getFullYear()}`;

  // ×™×¦×™×¨×ª ×ª×•×›×Ÿ ×”-CSV
  let csvContent = "××˜×œ×”,×‘×•×¦×¢\n"; // ×›×•×ª×¨×ª ×”×˜×‘×œ×”
  items.forEach(item => {
    csvContent += `"${item.text}","${item.done}"\n`;
  });

  // ×™×¦×™×¨×ª ×§×•×‘×¥ CSV
  const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });

  // ×™×¦×™×¨×ª ×©× ×”×§×•×‘×¥ ×¢× ×ª××¨×™×š
  const filename = `×¨×©×™××ª ××˜×œ×•×ª ××ª××¨×™×š ${date}.csv`;

  // ×™×¦×™×¨×ª ×œ×™× ×§ ×œ×”×•×¨×“×”
  const link = document.createElement("a");
  if (link.download !== undefined) { // ×× ×”×“×¤×“×¤×Ÿ ×ª×•××š ×‘×”×•×¨×“×”
    const url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", filename);
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }
}


function importCSV(input) {
  const file = input.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function (e) {
    const content = e.target.result;
    const rows = content.trim().split("\n");
    
    // ×“×œ×’ ×¢×œ ×›×•×ª×¨×ª ×”×˜×‘×œ×”
    for (let i = 1; i < rows.length; i++) {
      const [task, done] = rows[i].split(",");
      const li = document.createElement("li");
      li.appendChild(document.createTextNode(task.replace(/(^"|"$)/g, "").trim()));
      if (done && done.includes("âœ“")) {
        li.classList.add("checked");
      }

      // ×”×•×¡×£ ×›×¤×ª×•×¨ ××—×™×§×”
      const span = document.createElement("SPAN");
      const txt = document.createTextNode("\u00D7");
      span.className = "close";
      span.appendChild(txt);
      li.appendChild(span);
      span.onclick = function () {
        this.parentElement.style.display = "none";
      };

      document.getElementById("myUL").appendChild(li);
    }
    input.value = ''; // ××¤×¡ ××ª ×”×§×œ×˜
  };

  reader.readAsText(file, 'utf-8');
}


</script>

</body>
</html>
